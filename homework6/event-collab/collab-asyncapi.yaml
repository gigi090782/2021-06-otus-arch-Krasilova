asyncapi: 2.0.0
info:
  title: Регистрация пользователя
  version: '1.0.0'
  description: |
    Пример приложения/Event Collaboration
defaultContentType: application/json

channels:
  gateway/registrationRequested:
    publish:
      message:
        tags:
          - name: billing
        name: registrationRequested
        title: Пользователь запросил регистрацию
        payload:
           type: object
           properties:
             username:
               type: string
             firstName:
               type: string
             lastName:
               type: string
             email:
               type: string
             password:
               type: string
             phone:
               type: string
             address:
               type: string
        examples:
          - payload:
              username: ivan
              firstName: Иван
              lastName: Иванов
              email: ivan@ivanov.ru
              phone: '+79161112233'
              password: 'ivan111'
              address: 'ул Ленина д 1 кв 2'
            headers:
              correlationId: 3241-1231-3123-1231
              
  billing-service/userCreated:
    publish:
      message:
        name: userCreated
        payload:
           type: object
           properties:
             id:
               type: integer
               format: int64
             username:
               type: string
             firstName:
               type: string
             lastName:
               type: string
             email:
               type: string
             phone:
               type: string
             address:
               type: string
        examples:
          - payload:
              id: 42
              username: ivan
                firstName:  Иван
              lastName: Иванов
              email: ivan@ivanov.ru
              phone: '+79161112233'
              password: 'ivan111'
              address: 'ул Ленина д 1 кв 2'

  gateway/billingTransferRequested:
    publish:
      message:
        tags:
          - name: billing
        name: billingTransferRequested
        title: Пользователь запросил пополнение счета
        payload:
          type: object
          properties:
            price:
              type: integer
            userId:
              type: integer
        examples:
          - payload:
              price: 345678
              userId: 4343

  billing-service/billingTransferred:
    publish:
      message:
        name: billing
        payload:
          type: object
          properties:
            userId:
              type: integer
              format: int64
            price:
              type: integer
        examples:
          - payload:
              userId: 4343
              price: 345678

  gateway/billingWithdrawRequested:
    publish:
      message:
        tags:
          - name: billing
        name: billingWithdrawRequested
        title: Пользователь запросил снятие денежных средств
        payload:
          type: object
          properties:
            price:
              type: integer
            userId:
              type: integer
        examples:
          - payload:
              price: 345678
              userId: 4343

  gateway/createOrderRequest:
    publish:
      message:
        tags:
          - name: order
        name: createOrderRequest
        title: Пользователь запросил создание заказа
        payload:
          type: object
          properties:
            price:
              type: integer
            userId:
              type: integer
        examples:
          - payload:
              price: 345678
              userId: 4343

  order-service/orderCreated:
    publish:
      message:
        name: orderCreated
        payload:
          type: object
          properties:
            userId:
              type: integer
              format: int64
            price:
              type: integer
            orderId:
              type: integer
        examples:
          - payload:
              userId: 4343
              price: 345678
              orderId: 455765

  order-service/orderProcessRequest:
    publish:
      message:
        tags:
          - name: order
        name: orderProcessRequest
        title: Сервис заказов запросил обработку заказа
        payload:
          type: object
          properties:
            price:
              type: integer
            userId:
              type: integer
            orderId:
              type: integer
        examples:
          - payload:
              price: 345678
              userId: 4343
              orderId: 455765

  billing-service/orderProcessed:
    publish:
      message:
        name: orderProcessed
        payload:
          type: object
          properties:
            userId:
              type: integer
              format: int64
            price:
              type: integer
            orderId:
              type: integer
        examples:
          - payload:
              userId: 4343
              price: 345678
              orderId: 455765
